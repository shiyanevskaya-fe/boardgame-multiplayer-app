{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ar33\\\\OneDrive\\\\\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B\\\\vkr\\\\frontend\\\\src\\\\GameMobile.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport PlayersCity from './components/PlayersCity.js';\nimport PlayerTurn from './components/PlayerTurn.js';\nimport './styles/GameMobile.css';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GameMobile = () => {\n  _s();\n  const pathParts = window.location.pathname.split('/');\n  const roomCode = pathParts[pathParts.length - 2];\n  const player = JSON.parse(localStorage.getItem('player'));\n  const [currentPlayerId, setCurrentPlayerId] = useState(null);\n  useEffect(() => {\n    const socket = new WebSocket(`ws://192.168.1.68:8000/ws/rooms/${roomCode}/`);\n    socket.onmessage = event => {\n      const data = JSON.parse(event.data);\n      if (data.action === \"player_change\") {\n        console.log(\"Текущий пользовать изменился\");\n        setCurrentPlayerId(data.payload.id);\n      }\n    };\n    const fetchCurrentPlayer = async () => {\n      try {\n        const response_current_player = await axios.get(`http://192.168.1.68:8000/api/rooms/${roomCode}/current-player/`);\n        setCurrentPlayerId(response_current_player.data.id);\n      } catch (err) {\n        console.error(\"Не удалось получить текущего игрока:\", err);\n      }\n    };\n    fetchCurrentPlayer();\n    return () => {\n      socket.close();\n    };\n  }, [roomCode]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"GameMobile\",\n    children: player.id === currentPlayerId ? /*#__PURE__*/_jsxDEV(PlayerTurn, {\n      player: player,\n      roomCode: roomCode\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(PlayersCity, {\n      player: player,\n      isCurrent: player.id === currentPlayerId\n    }, player.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 9\n  }, this);\n};\n_s(GameMobile, \"anTFLscKSLohH/cLhtFlRbpfn0M=\");\n_c = GameMobile;\nexport default GameMobile;\nvar _c;\n$RefreshReg$(_c, \"GameMobile\");","map":{"version":3,"names":["React","useState","useEffect","PlayersCity","PlayerTurn","axios","jsxDEV","_jsxDEV","GameMobile","_s","pathParts","window","location","pathname","split","roomCode","length","player","JSON","parse","localStorage","getItem","currentPlayerId","setCurrentPlayerId","socket","WebSocket","onmessage","event","data","action","console","log","payload","id","fetchCurrentPlayer","response_current_player","get","err","error","close","className","children","fileName","_jsxFileName","lineNumber","columnNumber","isCurrent","_c","$RefreshReg$"],"sources":["C:/Users/ar33/OneDrive/Документы/vkr/frontend/src/GameMobile.js"],"sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport PlayersCity from './components/PlayersCity.js';\r\nimport PlayerTurn from './components/PlayerTurn.js';\r\nimport './styles/GameMobile.css';\r\nimport axios from 'axios';\r\n\r\nconst GameMobile = () =>{\r\n    const pathParts = window.location.pathname.split('/');\r\n    const roomCode = pathParts[pathParts.length - 2];\r\n\r\n    const player = JSON.parse(localStorage.getItem('player'));\r\n\r\n    const [currentPlayerId, setCurrentPlayerId] = useState(null);\r\n\r\n    useEffect(() => {\r\n        const socket = new WebSocket(`ws://192.168.1.68:8000/ws/rooms/${roomCode}/`);\r\n\r\n        socket.onmessage = (event) => {\r\n            const data = JSON.parse(event.data);\r\n            if (data.action === \"player_change\") {\r\n                console.log(\"Текущий пользовать изменился\");\r\n                setCurrentPlayerId(data.payload.id);\r\n            }\r\n        };\r\n        \r\n        const fetchCurrentPlayer = async () => {\r\n          try {\r\n            const response_current_player = await axios.get(`http://192.168.1.68:8000/api/rooms/${roomCode}/current-player/`);\r\n            setCurrentPlayerId(response_current_player.data.id);\r\n          } catch (err) {\r\n            console.error(\"Не удалось получить текущего игрока:\", err);\r\n          }\r\n        };\r\n      \r\n        fetchCurrentPlayer();\r\n\r\n        return () => {\r\n            socket.close();\r\n        };\r\n    }, [roomCode]);\r\n\r\n    return(\r\n        <div className='GameMobile'>\r\n            {player.id === currentPlayerId ? (\r\n                <PlayerTurn \r\n                    player={player} \r\n                    roomCode={roomCode}\r\n                />\r\n            ) : (\r\n                <PlayersCity\r\n                    key={player.id}\r\n                    player={player}\r\n                    isCurrent={player.id === currentPlayerId}\r\n                />\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default GameMobile;"],"mappings":";;AAAA,OAAOA,KAAK,IAAGC,QAAQ,EAAEC,SAAS,QAAO,OAAO;AAChD,OAAOC,WAAW,MAAM,6BAA6B;AACrD,OAAOC,UAAU,MAAM,4BAA4B;AACnD,OAAO,yBAAyB;AAChC,OAAOC,KAAK,MAAM,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1B,MAAMC,UAAU,GAAGA,CAAA,KAAK;EAAAC,EAAA;EACpB,MAAMC,SAAS,GAAGC,MAAM,CAACC,QAAQ,CAACC,QAAQ,CAACC,KAAK,CAAC,GAAG,CAAC;EACrD,MAAMC,QAAQ,GAAGL,SAAS,CAACA,SAAS,CAACM,MAAM,GAAG,CAAC,CAAC;EAEhD,MAAMC,MAAM,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC,CAAC;EAEzD,MAAM,CAACC,eAAe,EAAEC,kBAAkB,CAAC,GAAGtB,QAAQ,CAAC,IAAI,CAAC;EAE5DC,SAAS,CAAC,MAAM;IACZ,MAAMsB,MAAM,GAAG,IAAIC,SAAS,CAAC,mCAAmCV,QAAQ,GAAG,CAAC;IAE5ES,MAAM,CAACE,SAAS,GAAIC,KAAK,IAAK;MAC1B,MAAMC,IAAI,GAAGV,IAAI,CAACC,KAAK,CAACQ,KAAK,CAACC,IAAI,CAAC;MACnC,IAAIA,IAAI,CAACC,MAAM,KAAK,eAAe,EAAE;QACjCC,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC;QAC3CR,kBAAkB,CAACK,IAAI,CAACI,OAAO,CAACC,EAAE,CAAC;MACvC;IACJ,CAAC;IAED,MAAMC,kBAAkB,GAAG,MAAAA,CAAA,KAAY;MACrC,IAAI;QACF,MAAMC,uBAAuB,GAAG,MAAM9B,KAAK,CAAC+B,GAAG,CAAC,sCAAsCrB,QAAQ,kBAAkB,CAAC;QACjHQ,kBAAkB,CAACY,uBAAuB,CAACP,IAAI,CAACK,EAAE,CAAC;MACrD,CAAC,CAAC,OAAOI,GAAG,EAAE;QACZP,OAAO,CAACQ,KAAK,CAAC,sCAAsC,EAAED,GAAG,CAAC;MAC5D;IACF,CAAC;IAEDH,kBAAkB,CAAC,CAAC;IAEpB,OAAO,MAAM;MACTV,MAAM,CAACe,KAAK,CAAC,CAAC;IAClB,CAAC;EACL,CAAC,EAAE,CAACxB,QAAQ,CAAC,CAAC;EAEd,oBACIR,OAAA;IAAKiC,SAAS,EAAC,YAAY;IAAAC,QAAA,EACtBxB,MAAM,CAACgB,EAAE,KAAKX,eAAe,gBAC1Bf,OAAA,CAACH,UAAU;MACPa,MAAM,EAAEA,MAAO;MACfF,QAAQ,EAAEA;IAAS;MAAA2B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtB,CAAC,gBAEFtC,OAAA,CAACJ,WAAW;MAERc,MAAM,EAAEA,MAAO;MACf6B,SAAS,EAAE7B,MAAM,CAACgB,EAAE,KAAKX;IAAgB,GAFpCL,MAAM,CAACgB,EAAE;MAAAS,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAGjB;EACJ;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACA,CAAC;AAEd,CAAC;AAAApC,EAAA,CAnDKD,UAAU;AAAAuC,EAAA,GAAVvC,UAAU;AAqDhB,eAAeA,UAAU;AAAC,IAAAuC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}